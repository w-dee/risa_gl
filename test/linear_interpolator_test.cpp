#include <cppunit/extensions/HelperMacros.h>
#include <risa_gl/math/linear_interpolator.hpp>

#include "range.hpp"

class linear_interpolator_test : public CppUnit::TestFixture
{
private:
	CPPUNIT_TEST_SUITE(linear_interpolator_test);
	CPPUNIT_TEST(interpolate_test);
	CPPUNIT_TEST(transformed_geometry_test);
	CPPUNIT_TEST_SUITE_END();

	template <typename value_t>
	value_t display_transform(value_t source) const
	{
		return (source + value_t(1)) * value_t(320);
	}
public:
	void transformed_geometry_test()
	{
		// display_trans(-1)..display_trans(99/101)
		risa_gl::math::linear_interpolator<double>
			interpolator(display_transform(-1), -1, 0,
						 display_transform(99.0/101.0), -100, 100);

#define interpolate_test(x, y)								\
		{ \
			double interpolated = interpolator.interpolate(x);	\
			CPPUNIT_ASSERT_RANGE(interpolated, y, 0.25); \
	    }

		interpolate_test(0, 0.0);
		interpolate_test(1, 1/639.0);
		interpolate_test(2, 1/319.0);
		interpolate_test(3, 3/637.0);
		interpolate_test(4, 1/159.0);
		interpolate_test(5, 1/127.0);
		interpolate_test(6, 3/317.0);
		interpolate_test(7, 7/633.0);
		interpolate_test(8, 1/79.0);
		interpolate_test(9, 9/631.0);
		interpolate_test(10, 1/63.0);
		interpolate_test(11, 11/629.0);
		interpolate_test(12, 3/157.0);
		interpolate_test(13, 13/627.0);
		interpolate_test(14, 7/313.0);
		interpolate_test(15, 3/125.0);
		interpolate_test(16, 1/39.0);
		interpolate_test(17, 17/623.0);
		interpolate_test(18, 9/311.0);
		interpolate_test(19, 19/621.0);
		interpolate_test(20, 1/31.0);
		interpolate_test(21, 21/619.0);
		interpolate_test(22, 11/309.0);
		interpolate_test(23, 23/617.0);
		interpolate_test(24, 3/77.0);
		interpolate_test(25, 5/123.0);
		interpolate_test(26, 13/307.0);
		interpolate_test(27, 27/613.0);
		interpolate_test(28, 7/153.0);
		interpolate_test(29, 29/611.0);
		interpolate_test(30, 3/61.0);
		interpolate_test(31, 31/609.0);
		interpolate_test(32, 1/19.0);
		interpolate_test(33, 33/607.0);
		interpolate_test(34, 17/303.0);
		interpolate_test(35, 7/121.0);
		interpolate_test(36, 9/151.0);
		interpolate_test(37, 37/603.0);
		interpolate_test(38, 19/301.0);
		interpolate_test(39, 39/601.0);
		interpolate_test(40, 1/15.0);
		interpolate_test(41, 41/599.0);
		interpolate_test(42, 21/299.0);
		interpolate_test(43, 43/597.0);
		interpolate_test(44, 11/149.0);
		interpolate_test(45, 9/119.0);
		interpolate_test(46, 23/297.0);
		interpolate_test(47, 47/593.0);
		interpolate_test(48, 3/37.0);
		interpolate_test(49, 49/591.0);
		interpolate_test(50, 5/59.0);
		interpolate_test(51, 51/589.0);
		interpolate_test(52, 13/147.0);
		interpolate_test(53, 53/587.0);
		interpolate_test(54, 27/293.0);
		interpolate_test(55, 11/117.0);
		interpolate_test(56, 7/73.0);
		interpolate_test(57, 57/583.0);
		interpolate_test(58, 29/291.0);
		interpolate_test(59, 59/581.0);
		interpolate_test(60, 3/29.0);
		interpolate_test(61, 61/579.0);
		interpolate_test(62, 31/289.0);
		interpolate_test(63, 63/577.0);
		interpolate_test(64, 1/9.0);
		interpolate_test(65, 13/115.0);
		interpolate_test(66, 33/287.0);
		interpolate_test(67, 67/573.0);
		interpolate_test(68, 17/143.0);
		interpolate_test(69, 69/571.0);
		interpolate_test(70, 7/57.0);
		interpolate_test(71, 71/569.0);
		interpolate_test(72, 9/71.0);
		interpolate_test(73, 73/567.0);
		interpolate_test(74, 37/283.0);
		interpolate_test(75, 15/113.0);
		interpolate_test(76, 19/141.0);
		interpolate_test(77, 77/563.0);
		interpolate_test(78, 39/281.0);
		interpolate_test(79, 79/561.0);
		interpolate_test(80, 1/7.0);
		interpolate_test(81, 81/559.0);
		interpolate_test(82, 41/279.0);
		interpolate_test(83, 83/557.0);
		interpolate_test(84, 21/139.0);
		interpolate_test(85, 17/111.0);
		interpolate_test(86, 43/277.0);
		interpolate_test(87, 87/553.0);
		interpolate_test(88, 11/69.0);
		interpolate_test(89, 89/551.0);
		interpolate_test(90, 9/55.0);
		interpolate_test(91, 91/549.0);
		interpolate_test(92, 23/137.0);
		interpolate_test(93, 93/547.0);
		interpolate_test(94, 47/273.0);
		interpolate_test(95, 19/109.0);
		interpolate_test(96, 3/17.0);
		interpolate_test(97, 97/543.0);
		interpolate_test(98, 49/271.0);
		interpolate_test(99, 99/541.0);
		interpolate_test(100, 5/27.0);
		interpolate_test(101, 101/539.0);
		interpolate_test(102, 51/269.0);
		interpolate_test(103, 103/537.0);
		interpolate_test(104, 13/67.0);
		interpolate_test(105, 21/107.0);
		interpolate_test(106, 53/267.0);
		interpolate_test(107, 107/533.0);
		interpolate_test(108, 27/133.0);
		interpolate_test(109, 109/531.0);
		interpolate_test(110, 11/53.0);
		interpolate_test(111, 111/529.0);
		interpolate_test(112, 7/33.0);
		interpolate_test(113, 113/527.0);
		interpolate_test(114, 57/263.0);
		interpolate_test(115, 23/105.0);
		interpolate_test(116, 29/131.0);
		interpolate_test(117, 117/523.0);
		interpolate_test(118, 59/261.0);
		interpolate_test(119, 119/521.0);
		interpolate_test(120, 3/13.0);
		interpolate_test(121, 121/519.0);
		interpolate_test(122, 61/259.0);
		interpolate_test(123, 123/517.0);
		interpolate_test(124, 31/129.0);
		interpolate_test(125, 25/103.0);
		interpolate_test(126, 63/257.0);
		interpolate_test(127, 127/513.0);
		interpolate_test(128, 1/4.0);
		interpolate_test(129, 129/511.0);
		interpolate_test(130, 13/51.0);
		interpolate_test(131, 131/509.0);
		interpolate_test(132, 33/127.0);
		interpolate_test(133, 133/507.0);
		interpolate_test(134, 67/253.0);
		interpolate_test(135, 27/101.0);
		interpolate_test(136, 17/63.0);
		interpolate_test(137, 137/503.0);
		interpolate_test(138, 69/251.0);
		interpolate_test(139, 139/501.0);
		interpolate_test(140, 7/25.0);
		interpolate_test(141, 141/499.0);
		interpolate_test(142, 71/249.0);
		interpolate_test(143, 143/497.0);
		interpolate_test(144, 9/31.0);
		interpolate_test(145, 29/99.0);
		interpolate_test(146, 73/247.0);
		interpolate_test(147, 147/493.0);
		interpolate_test(148, 37/123.0);
		interpolate_test(149, 149/491.0);
		interpolate_test(150, 15/49.0);
		interpolate_test(151, 151/489.0);
		interpolate_test(152, 19/61.0);
		interpolate_test(153, 153/487.0);
		interpolate_test(154, 77/243.0);
		interpolate_test(155, 31/97.0);
		interpolate_test(156, 39/121.0);
		interpolate_test(157, 157/483.0);
		interpolate_test(158, 79/241.0);
		interpolate_test(159, 159/481.0);
		interpolate_test(160, 1/3.0);
		interpolate_test(161, 161/479.0);
		interpolate_test(162, 81/239.0);
		interpolate_test(163, 163/477.0);
		interpolate_test(164, 41/119.0);
		interpolate_test(165, 33/95.0);
		interpolate_test(166, 83/237.0);
		interpolate_test(167, 167/473.0);
		interpolate_test(168, 21/59.0);
		interpolate_test(169, 169/471.0);
		interpolate_test(170, 17/47.0);
		interpolate_test(171, 171/469.0);
		interpolate_test(172, 43/117.0);
		interpolate_test(173, 173/467.0);
		interpolate_test(174, 87/233.0);
		interpolate_test(175, 35/93.0);
		interpolate_test(176, 11/29.0);
		interpolate_test(177, 177/463.0);
		interpolate_test(178, 89/231.0);
		interpolate_test(179, 179/461.0);
		interpolate_test(180, 9/23.0);
		interpolate_test(181, 181/459.0);
		interpolate_test(182, 91/229.0);
		interpolate_test(183, 183/457.0);
		interpolate_test(184, 23/57.0);
		interpolate_test(185, 37/91.0);
		interpolate_test(186, 93/227.0);
		interpolate_test(187, 187/453.0);
		interpolate_test(188, 47/113.0);
		interpolate_test(189, 189/451.0);
		interpolate_test(190, 19/45.0);
		interpolate_test(191, 191/449.0);
		interpolate_test(192, 3/7.0);
		interpolate_test(193, 193/447.0);
		interpolate_test(194, 97/223.0);
		interpolate_test(195, 39/89.0);
		interpolate_test(196, 49/111.0);
		interpolate_test(197, 197/443.0);
		interpolate_test(198, 99/221.0);
		interpolate_test(199, 199/441.0);
		interpolate_test(200, 5/11.0);
		interpolate_test(201, 201/439.0);
		interpolate_test(202, 101/219.0);
		interpolate_test(203, 203/437.0);
		interpolate_test(204, 51/109.0);
		interpolate_test(205, 41/87.0);
		interpolate_test(206, 103/217.0);
		interpolate_test(207, 207/433.0);
		interpolate_test(208, 13/27.0);
		interpolate_test(209, 209/431.0);
		interpolate_test(210, 21/43.0);
		interpolate_test(211, 211/429.0);
		interpolate_test(212, 53/107.0);
		interpolate_test(213, 213/427.0);
		interpolate_test(214, 107/213.0);
		interpolate_test(215, 43/85.0);
		interpolate_test(216, 27/53.0);
		interpolate_test(217, 217/423.0);
		interpolate_test(218, 109/211.0);
		interpolate_test(219, 219/421.0);
		interpolate_test(220, 11/21.0);
		interpolate_test(221, 221/419.0);
		interpolate_test(222, 111/209.0);
		interpolate_test(223, 223/417.0);
		interpolate_test(224, 7/13.0);
		interpolate_test(225, 45/83.0);
		interpolate_test(226, 113/207.0);
		interpolate_test(227, 227/413.0);
		interpolate_test(228, 57/103.0);
		interpolate_test(229, 229/411.0);
		interpolate_test(230, 23/41.0);
		interpolate_test(231, 231/409.0);
		interpolate_test(232, 29/51.0);
		interpolate_test(233, 233/407.0);
		interpolate_test(234, 117/203.0);
		interpolate_test(235, 47/81.0);
		interpolate_test(236, 59/101.0);
		interpolate_test(237, 237/403.0);
		interpolate_test(238, 119/201.0);
		interpolate_test(239, 239/401.0);
		interpolate_test(240, 3/5.0);
		interpolate_test(241, 241/399.0);
		interpolate_test(242, 121/199.0);
		interpolate_test(243, 243/397.0);
		interpolate_test(244, 61/99.0);
		interpolate_test(245, 49/79.0);
		interpolate_test(246, 123/197.0);
		interpolate_test(247, 247/393.0);
		interpolate_test(248, 31/49.0);
		interpolate_test(249, 249/391.0);
		interpolate_test(250, 25/39.0);
		interpolate_test(251, 251/389.0);
		interpolate_test(252, 63/97.0);
		interpolate_test(253, 253/387.0);
		interpolate_test(254, 127/193.0);
		interpolate_test(255, 51/77.0);
		interpolate_test(256, 2/3.0);
		interpolate_test(257, 257/383.0);
		interpolate_test(258, 129/191.0);
		interpolate_test(259, 259/381.0);
		interpolate_test(260, 13/19.0);
		interpolate_test(261, 261/379.0);
		interpolate_test(262, 131/189.0);
		interpolate_test(263, 263/377.0);
		interpolate_test(264, 33/47.0);
		interpolate_test(265, 53/75.0);
		interpolate_test(266, 133/187.0);
		interpolate_test(267, 267/373.0);
		interpolate_test(268, 67/93.0);
		interpolate_test(269, 269/371.0);
		interpolate_test(270, 27/37.0);
		interpolate_test(271, 271/369.0);
		interpolate_test(272, 17/23.0);
		interpolate_test(273, 273/367.0);
		interpolate_test(274, 137/183.0);
		interpolate_test(275, 55/73.0);
		interpolate_test(276, 69/91.0);
		interpolate_test(277, 277/363.0);
		interpolate_test(278, 139/181.0);
		interpolate_test(279, 279/361.0);
		interpolate_test(280, 7/9.0);
		interpolate_test(281, 281/359.0);
		interpolate_test(282, 141/179.0);
		interpolate_test(283, 283/357.0);
		interpolate_test(284, 71/89.0);
		interpolate_test(285, 57/71.0);
		interpolate_test(286, 143/177.0);
		interpolate_test(287, 287/353.0);
		interpolate_test(288, 9/11.0);
		interpolate_test(289, 289/351.0);
		interpolate_test(290, 29/35.0);
		interpolate_test(291, 291/349.0);
		interpolate_test(292, 73/87.0);
		interpolate_test(293, 293/347.0);
		interpolate_test(294, 147/173.0);
		interpolate_test(295, 59/69.0);
		interpolate_test(296, 37/43.0);
		interpolate_test(297, 297/343.0);
		interpolate_test(298, 149/171.0);
		interpolate_test(299, 299/341.0);
		interpolate_test(300, 15/17.0);
		interpolate_test(301, 301/339.0);
		interpolate_test(302, 151/169.0);
		interpolate_test(303, 303/337.0);
		interpolate_test(304, 19/21.0);
		interpolate_test(305, 61/67.0);
		interpolate_test(306, 153/167.0);
		interpolate_test(307, 307/333.0);
		interpolate_test(308, 77/83.0);
		interpolate_test(309, 309/331.0);
		interpolate_test(310, 31/33.0);
		interpolate_test(311, 311/329.0);
		interpolate_test(312, 39/41.0);
		interpolate_test(313, 313/327.0);
		interpolate_test(314, 157/163.0);
		interpolate_test(315, 63/65.0);
		interpolate_test(316, 79/81.0);
		interpolate_test(317, 317/323.0);
		interpolate_test(318, 159/161.0);
		interpolate_test(319, 319/321.0);

		interpolate_test(322, 161/159.0);
		interpolate_test(323, 323/317.0);
		interpolate_test(324, 81/79.0);
		interpolate_test(325, 65/63.0);
		interpolate_test(326, 163/157.0);
		interpolate_test(327, 327/313.0);
		interpolate_test(328, 41/39.0);
		interpolate_test(329, 329/311.0);
		interpolate_test(330, 33/31.0);
		interpolate_test(331, 331/309.0);
		interpolate_test(332, 83/77.0);
		interpolate_test(333, 333/307.0);
		interpolate_test(334, 167/153.0);
		interpolate_test(335, 67/61.0);
		interpolate_test(336, 21/19.0);
		interpolate_test(337, 337/303.0);
		interpolate_test(338, 169/151.0);
		interpolate_test(339, 339/301.0);
		interpolate_test(340, 17/15.0);
		interpolate_test(341, 341/299.0);
		interpolate_test(342, 171/149.0);
		interpolate_test(343, 343/297.0);
		interpolate_test(344, 43/37.0);
		interpolate_test(345, 69/59.0);
		interpolate_test(346, 173/147.0);
		interpolate_test(347, 347/293.0);
		interpolate_test(348, 87/73.0);
		interpolate_test(349, 349/291.0);
		interpolate_test(350, 35/29.0);
		interpolate_test(351, 351/289.0);
		interpolate_test(352, 11/9.0);
		interpolate_test(353, 353/287.0);
		interpolate_test(354, 177/143.0);
		interpolate_test(355, 71/57.0);
		interpolate_test(356, 89/71.0);
		interpolate_test(357, 357/283.0);
		interpolate_test(358, 179/141.0);
		interpolate_test(359, 359/281.0);
		interpolate_test(360, 9/7.0);
		interpolate_test(361, 361/279.0);
		interpolate_test(362, 181/139.0);
		interpolate_test(363, 363/277.0);
		interpolate_test(364, 91/69.0);
		interpolate_test(365, 73/55.0);
		interpolate_test(366, 183/137.0);
		interpolate_test(367, 367/273.0);
		interpolate_test(368, 23/17.0);
		interpolate_test(369, 369/271.0);
		interpolate_test(370, 37/27.0);
		interpolate_test(371, 371/269.0);
		interpolate_test(372, 93/67.0);
		interpolate_test(373, 373/267.0);
		interpolate_test(374, 187/133.0);
		interpolate_test(375, 75/53.0);
		interpolate_test(376, 47/33.0);
		interpolate_test(377, 377/263.0);
		interpolate_test(378, 189/131.0);
		interpolate_test(379, 379/261.0);
		interpolate_test(380, 19/13.0);
		interpolate_test(381, 381/259.0);
		interpolate_test(382, 191/129.0);
		interpolate_test(383, 383/257.0);
		interpolate_test(384, 3/2.0);
		interpolate_test(385, 77/51.0);
		interpolate_test(386, 193/127.0);
		interpolate_test(387, 387/253.0);
		interpolate_test(388, 97/63.0);
		interpolate_test(389, 389/251.0);
		interpolate_test(390, 39/25.0);
		interpolate_test(391, 391/249.0);
		interpolate_test(392, 49/31.0);
		interpolate_test(393, 393/247.0);
		interpolate_test(394, 197/123.0);
		interpolate_test(395, 79/49.0);
		interpolate_test(396, 99/61.0);
		interpolate_test(397, 397/243.0);
		interpolate_test(398, 199/121.0);
		interpolate_test(399, 399/241.0);
		interpolate_test(400, 5/3.0);
		interpolate_test(401, 401/239.0);
		interpolate_test(402, 201/119.0);
		interpolate_test(403, 403/237.0);
		interpolate_test(404, 101/59.0);
		interpolate_test(405, 81/47.0);
		interpolate_test(406, 203/117.0);
		interpolate_test(407, 407/233.0);
		interpolate_test(408, 51/29.0);
		interpolate_test(409, 409/231.0);
		interpolate_test(410, 41/23.0);
		interpolate_test(411, 411/229.0);
		interpolate_test(412, 103/57.0);
		interpolate_test(413, 413/227.0);
		interpolate_test(414, 207/113.0);
		interpolate_test(415, 83/45.0);
		interpolate_test(416, 13/7.0);
		interpolate_test(417, 417/223.0);
		interpolate_test(418, 209/111.0);
		interpolate_test(419, 419/221.0);
		interpolate_test(420, 21/11.0);
		interpolate_test(421, 421/219.0);
		interpolate_test(422, 211/109.0);
		interpolate_test(423, 423/217.0);
		interpolate_test(424, 53/27.0);
		interpolate_test(425, 85/43.0);
		interpolate_test(426, 213/107.0);
		interpolate_test(427, 427/213.0);
		interpolate_test(428, 107/53.0);
		interpolate_test(429, 429/211.0);
		interpolate_test(430, 43/21.0);
		interpolate_test(431, 431/209.0);
		interpolate_test(432, 27/13.0);
		interpolate_test(433, 433/207.0);
		interpolate_test(434, 217/103.0);
		interpolate_test(435, 87/41.0);
		interpolate_test(436, 109/51.0);
		interpolate_test(437, 437/203.0);
		interpolate_test(438, 219/101.0);
		interpolate_test(439, 439/201.0);
		interpolate_test(440, 11/5.0);
		interpolate_test(441, 441/199.0);
		interpolate_test(442, 221/99.0);
		interpolate_test(443, 443/197.0);
		interpolate_test(444, 111/49.0);
		interpolate_test(445, 89/39.0);
		interpolate_test(446, 223/97.0);
		interpolate_test(447, 447/193.0);
		interpolate_test(448, 7/3.0);
		interpolate_test(449, 449/191.0);
		interpolate_test(450, 45/19.0);
		interpolate_test(451, 451/189.0);
		interpolate_test(452, 113/47.0);
		interpolate_test(453, 453/187.0);
		interpolate_test(454, 227/93.0);
		interpolate_test(455, 91/37.0);
		interpolate_test(456, 57/23.0);
		interpolate_test(457, 457/183.0);
		interpolate_test(458, 229/91.0);
		interpolate_test(459, 459/181.0);
		interpolate_test(460, 23/9.0);
		interpolate_test(461, 461/179.0);
		interpolate_test(462, 231/89.0);
		interpolate_test(463, 463/177.0);
		interpolate_test(464, 29/11.0);
		interpolate_test(465, 93/35.0);
		interpolate_test(466, 233/87.0);
		interpolate_test(467, 467/173.0);
		interpolate_test(468, 117/43.0);
		interpolate_test(469, 469/171.0);
		interpolate_test(470, 47/17.0);
		interpolate_test(471, 471/169.0);
		interpolate_test(472, 59/21.0);
		interpolate_test(473, 473/167.0);
		interpolate_test(474, 237/83.0);
		interpolate_test(475, 95/33.0);
		interpolate_test(476, 119/41.0);
		interpolate_test(477, 477/163.0);
		interpolate_test(478, 239/81.0);
		interpolate_test(479, 479/161.0);
		interpolate_test(482, 241/79.0);
		interpolate_test(483, 483/157.0);
		interpolate_test(484, 121/39.0);
		interpolate_test(485, 97/31.0);
		interpolate_test(486, 243/77.0);
		interpolate_test(487, 487/153.0);
		interpolate_test(488, 61/19.0);
		interpolate_test(489, 489/151.0);
		interpolate_test(490, 49/15.0);
		interpolate_test(491, 491/149.0);
		interpolate_test(492, 123/37.0);
		interpolate_test(493, 493/147.0);
		interpolate_test(494, 247/73.0);
		interpolate_test(495, 99/29.0);
		interpolate_test(496, 31/9.0);
		interpolate_test(497, 497/143.0);
		interpolate_test(498, 249/71.0);
		interpolate_test(499, 499/141.0);
		interpolate_test(500, 25/7.0);
		interpolate_test(501, 501/139.0);
		interpolate_test(502, 251/69.0);
		interpolate_test(503, 503/137.0);
		interpolate_test(504, 63/17.0);
		interpolate_test(505, 101/27.0);
		interpolate_test(506, 253/67.0);
		interpolate_test(507, 507/133.0);
		interpolate_test(508, 127/33.0);
		interpolate_test(509, 509/131.0);
		interpolate_test(510, 51/13.0);
		interpolate_test(511, 511/129.0);
		
		interpolate_test(514, 257/63.0);
		interpolate_test(515, 103/25.0);
		interpolate_test(516, 129/31.0);
		interpolate_test(517, 517/123.0);
		interpolate_test(518, 259/61.0);
		interpolate_test(519, 519/121.0);
		interpolate_test(520, 13/3.0);
		interpolate_test(521, 521/119.0);
		interpolate_test(522, 261/59.0);
		interpolate_test(523, 523/117.0);
		interpolate_test(524, 131/29.0);
		interpolate_test(525, 105/23.0);
		interpolate_test(526, 263/57.0);
		interpolate_test(527, 527/113.0);
		interpolate_test(528, 33/7.0);
		interpolate_test(529, 529/111.0);
		interpolate_test(530, 53/11.0);
		interpolate_test(531, 531/109.0);
		interpolate_test(532, 133/27.0);
		interpolate_test(533, 533/107.0);
		interpolate_test(534, 267/53.0);
		interpolate_test(535, 107/21.0);
		interpolate_test(536, 67/13.0);
		interpolate_test(537, 537/103.0);
		interpolate_test(538, 269/51.0);
		interpolate_test(539, 539/101.0);
		interpolate_test(540, 27/5.0);
		interpolate_test(541, 541/99.0);
		interpolate_test(542, 271/49.0);
		interpolate_test(543, 543/97.0);
		interpolate_test(544, 17/3.0);
		interpolate_test(545, 109/19.0);
		interpolate_test(546, 273/47.0);
		interpolate_test(547, 547/93.0);
		interpolate_test(548, 137/23.0);
		interpolate_test(549, 549/91.0);
		interpolate_test(550, 55/9.0);
		interpolate_test(551, 551/89.0);
		interpolate_test(552, 69/11.0);
		interpolate_test(553, 553/87.0);
		interpolate_test(554, 277/43.0);
		interpolate_test(555, 111/17.0);
		interpolate_test(556, 139/21.0);
		interpolate_test(557, 557/83.0);
		interpolate_test(558, 279/41.0);
		interpolate_test(559, 559/81.0);

		interpolate_test(562, 281/39.0);
		interpolate_test(563, 563/77.0);
		interpolate_test(564, 141/19.0);
		interpolate_test(565, 113/15.0);
		interpolate_test(566, 283/37.0);
		interpolate_test(567, 567/73.0);
		interpolate_test(568, 71/9.0);
		interpolate_test(569, 569/71.0);
		interpolate_test(570, 57/7.0);
		interpolate_test(571, 571/69.0);
		interpolate_test(572, 143/17.0);
		interpolate_test(573, 573/67.0);
		interpolate_test(574, 287/33.0);
		interpolate_test(575, 115/13.0);

		interpolate_test(578, 289/31.0);
		interpolate_test(579, 579/61.0);
		interpolate_test(580, 29/3.0);
		interpolate_test(581, 581/59.0);
		interpolate_test(582, 291/29.0);
		interpolate_test(583, 583/57.0);
		interpolate_test(584, 73/7.0);
		interpolate_test(585, 117/11.0);
		interpolate_test(586, 293/27.0);
		interpolate_test(587, 587/53.0);
		interpolate_test(588, 147/13.0);
		interpolate_test(589, 589/51.0);
		interpolate_test(590, 59/5.0);
		interpolate_test(591, 591/49.0);
		interpolate_test(592, 37/3.0);
		interpolate_test(593, 593/47.0);
		interpolate_test(594, 297/23.0);
		interpolate_test(595, 119/9.0);
		interpolate_test(596, 149/11.0);
		interpolate_test(597, 597/43.0);
		interpolate_test(598, 299/21.0);
		interpolate_test(599, 599/41.0);

		interpolate_test(602, 301/19.0);
		interpolate_test(603, 603/37.0);
		interpolate_test(604, 151/9.0);
		interpolate_test(605, 121/7.0);
		interpolate_test(606, 303/17.0);
		interpolate_test(607, 607/33.0);

		interpolate_test(610, 61/3.0);
		interpolate_test(611, 611/29.0);
		interpolate_test(612, 153/7.0);
		interpolate_test(613, 613/27.0);
		interpolate_test(614, 307/13.0);
		interpolate_test(615, 123/5.0);
		interpolate_test(616, 77/3.0);
		interpolate_test(617, 617/23.0);
		interpolate_test(618, 309/11.0);
		interpolate_test(619, 619/21.0);
		interpolate_test(620, 31.0);
		interpolate_test(621, 621/19.0);
		interpolate_test(622, 311/9.0);
		interpolate_test(623, 623/17.0);
		interpolate_test(624, 39.0);
		interpolate_test(625, 125/3.0);
		interpolate_test(626, 313/7.0);
		interpolate_test(627, 627/13.0);
		interpolate_test(628, 157/3.0);
		interpolate_test(629, 629/11.0);
		interpolate_test(630, 63.0);
		interpolate_test(631, 631/9.0);
		interpolate_test(632, 79.0);
		interpolate_test(633, 633/7.0);

#undef interpolate_test
	}

	void interpolate_test()
	{

		/**
		 * (-1, 0, -1, 1) -> project -> (-1, 0, 1, 1)
		 *  -> (-1, 0, 1, 1)
		 *
		 * (0, 0, -50.5, 1) -> project -> (0, 0, -49.5, 50.5)
		 *  -> (0, 0, -49.5/50.5, 1)
		 *
		 * (1, 0, -100, 1) -> project -> (1, 0, -100, 100)
		 *  -> (1/100, 0, -1, 1)
		 *
		 */

		using risa_gl::math::linear_interpolator;
		linear_interpolator<double> interpolator(-1, -1, 0,
												 99.0/101.0, -100, 100);
		double interpolated = interpolator.interpolate(0);
		CPPUNIT_ASSERT_RANGE(interpolated, 1.0, 0.01);

		interpolated = interpolator.interpolate(0.5);
		CPPUNIT_ASSERT_RANGE(interpolated, 3.0, 0.03);

		interpolated = interpolator.interpolate(0.75);
		CPPUNIT_ASSERT_RANGE(interpolated, 7.0, 0.07);

		interpolated = interpolator.interpolate(99.0/101.0);
		CPPUNIT_ASSERT_RANGE(interpolated, 100.0, 0.01);
	}

};

CPPUNIT_TEST_SUITE_REGISTRATION( linear_interpolator_test );

